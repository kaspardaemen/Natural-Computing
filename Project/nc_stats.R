
library(tidyverse)
library(ggplot2)

#RANDOM FOREST

#pl

mean(baseline_rf_pl)
sd(baseline_rf_pl)

pl <- read.csv(file = 'rf_pl.csv')


ggplot(pl, aes(x=Iterations, y=Means, fill=Method)) + 
  geom_line(aes( color=Method)) +
  geom_point(aes (color=Method)) +
  geom_ribbon(aes(ymin=Means-CI, ymax=Means+CI), linetype=2, alpha=0.1) +
  theme_bw() +
  xlab('iterations') +
  ylab('test accuracy') 

#t-test: rfc

#400 iteration results
rf_rs_income <- c(0.6114484,	0.60624458,	0.60624458,	0.6114484,	0.60624458)
rf_ga_income <- c(0.868402,	0.864473,	0.867420,	0.865946,	0.866438)

#Income

income <- read.csv(file = 'rf_income.csv')

baseline_rf_income <- c(0.8563712251411736, 0.8526884360422293, 0.8556346673213847, 0.8571077829609625, 0.8553891480481218, 0.8553891480481218, 0.85440707095507, 0.8561257058679106, 0.8531794745887552, 0.8553891480481218, 0.8558801865946477, 0.8541615516818071, 0.8534249938620182, 0.8536705131352811, 0.85440707095507, 0.85440707095507, 0.8541615516818071, 0.8531794745887552, 0.8531794745887552, 0.8573533022342253, 0.8536705131352811, 0.854652590228333, 0.8553891480481218, 0.8526884360422293, 0.8553891480481218, 0.8521973974957034, 0.8563712251411736, 0.8539160324085441, 0.8521973974957034, 0.8548981095015958)
mean(baseline_rf_income)
sd(baseline_rf_income)

ggplot(income, aes(x=Iterations, y=Means, fill=Method)) + 
  geom_line(aes( color=Method)) +
  geom_point(aes(color=Method)) +
  geom_ribbon(aes(ymin=Means-CI, ymax=Means+CI), linetype=2, alpha=0.1) +
  theme_bw() +
  xlab('iterations') +
  ylab('test accuracy') +
  labs(title = 'Random Forest optimization on the income dataset')

#GRADIENT BOOSTING

#income
income_gb <- read.csv(file = 'gb_income.csv') 
baseline_gb_income <- c(0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916, 0.8661919960716916)
mean(baseline_gb_income)
sd(baseline_gb_income)

ggplot(income_gb, aes(x=Iterations, y=Means, fill=Method)) + 
  geom_line(aes( color=Method)) +
  geom_point(aes(color=Method)) +
  geom_ribbon(aes(ymin=Means-CI, ymax=Means+CI), linetype=2, alpha=0.1) +
  theme_bw() +
  xlab('iterations') +
  ylab('test accuracy') 



#pl
pl_gb <- read.csv(file = 'gb_pl.csv') 

baseline_gb_pl <- c(0.6510416666666666, 0.6510416666666666, 0.6536458333333334, 0.6510416666666666, 0.6510416666666666, 0.6484375, 0.6510416666666666, 0.6510416666666666, 0.6536458333333334, 0.640625, 0.6510416666666666, 0.640625, 0.6484375, 0.6510416666666666, 0.6510416666666666, 0.6510416666666666, 0.6510416666666666, 0.6510416666666666, 0.640625, 0.6380208333333334, 0.640625, 0.6510416666666666, 0.6536458333333334, 0.6510416666666666, 0.6510416666666666, 0.6536458333333334, 0.6510416666666666, 0.6484375, 0.6380208333333334, 0.6380208333333334)



mean(baseline_gb_pl)
sd(baseline_gb_pl)

ggplot(pl_gb, aes(x=Iterations, y=Means, fill=Method)) + 
  geom_line(aes( color=Method)) +
  geom_point(aes(color=Method)) +
  geom_ribbon(aes(ymin=Means-CI, ymax=Means+CI), linetype=2, alpha=0.1) +
  theme_bw() +
  xlab('iterations') +
  ylab('test accuracy') 



#Statistical analysis

gb_grid_income <- c(0.8715934200834765, 0.8713479008102136, 0.869138227350847, 0.8706113429904248, 0.8723299779032654, 0.8728210164497913, 0.8757672477289468, 0.8735575742695801, 0.8708568622636877, 0.8698747851706359, 0.8738030935428431, 0.86938374662411, 0.8755217284556838, 0.8706113429904248, 0.8725754971765284, 0.8723299779032654, 0.8738030935428431, 0.8723299779032654, 0.8676651117112694, 0.869629265897373, 0.8703658237171618, 0.8701203044438989, 0.8723299779032654, 0.8738030935428431, 0.8738030935428431, 0.874294132089369, 0.8698747851706359, 0.8713479008102136, 0.8720844586300025, 0.874294132089369)
rfc_grid_income <- c(0.864227841885588, 0.8654554382519027, 0.8659464767984286, 0.8661919960716916, 0.864227841885588, 0.864473361158851, 0.8634912840657991, 0.8666830346182175, 0.8659464767984286, 0.8666830346182175, 0.8654554382519027, 0.8666830346182175, 0.8647188804321139, 0.8686471888043211, 0.8684016695310582, 0.8649643997053769, 0.8622636876994844, 0.8669285538914805, 0.8654554382519027, 0.8661919960716916, 0.8652099189786399, 0.8661919960716916, 0.8647188804321139, 0.8652099189786399, 0.8652099189786399, 0.8652099189786399, 0.8649643997053769, 0.8664375153449546, 0.8647188804321139, 0.864473361158851)
rfc_grid_pl <- c(0.6145833333333334, 0.6223958333333334, 0.6041666666666666, 0.6145833333333334, 0.6197916666666666, 0.6354166666666666, 0.6119791666666666, 0.6276041666666666, 0.6171875, 0.6171875, 0.6197916666666666, 0.6302083333333334, 0.6380208333333334, 0.6171875, 0.6145833333333334, 0.625, 0.609375, 0.6302083333333334, 0.6328125, 0.6197916666666666, 0.625, 0.6067708333333334, 0.625, 0.6119791666666666, 0.6197916666666666, 0.6354166666666666, 0.6145833333333334, 0.609375, 0.6119791666666666, 0.625)
gb_grid_pl <-  c(0.6510416666666666, 0.6328125, 0.6588541666666666, 0.6536458333333334, 0.6484375, 0.6588541666666666, 0.6484375, 0.6666666666666666, 0.6510416666666666, 0.6536458333333334, 0.6666666666666666, 0.6328125, 0.6744791666666666, 0.6484375, 0.6666666666666666, 0.6536458333333334, 0.6510416666666666, 0.6380208333333334, 0.6458333333333334, 0.65625, 0.6510416666666666, 0.6640625, 0.6484375, 0.6692708333333334, 0.6484375, 0.65625, 0.6666666666666666, 0.6614583333333334, 0.6510416666666666, 0.6510416666666666)

baseline_rf_pl <- c(0.6171875, 0.5989583333333334, 0.6171875, 0.6302083333333334, 0.625, 0.5755208333333334, 0.6041666666666666, 0.6145833333333334, 0.6171875, 0.6041666666666666, 0.6171875, 0.5989583333333334, 0.6015625, 0.6015625, 0.6067708333333334, 0.5989583333333334, 0.5911458333333334, 0.6302083333333334, 0.6145833333333334, 0.6145833333333334, 0.6119791666666666, 0.6067708333333334, 0.6145833333333334, 0.5963541666666666, 0.6223958333333334, 0.6067708333333334, 0.6302083333333334, 0.625, 0.5963541666666666, 0.5963541666666666)

round(qt(0.975, 30)*sd(gb_grid_pl)/(sqrt(30)), 5)


tt_gb_grid_pl <-  t.test(gb_grid_pl,baseline_gb_pl, alternative = "two.sided", var.equal = FALSE)
tt_rfc_grid_pl <-  t.test(rfc_grid_pl,baseline_rf_pl, alternative = "two.sided", var.equal = FALSE)

tt_gb_grid_income <- t.test(gb_grid_income, baseline_gb_income, alternative = "two.sided", var.equal = FALSE)
tt_rfc_grid_income <- t.test(rfc_grid_income,baseline_rf_income, alternative = "two.sided", var.equal = FALSE)

#400 resultaten
rf_rs_income <- c(0.8637368,	0.86422784,	0.86545544,	0.86447336,	0.86545544)
rf_ga_income <- c(0.868402,	0.864473,	0.867420,	0.865946,	0.866438)

rf_ga_pl <- c(0.622396,	0.632813,	0.630208,	0.630208,	0.614583)
rf_rs_pl <- c(0.6114484,	0.60624458,	0.60624458,	0.6114484,	0.60624458)

gb_rs_pl <- c(0.63920208,	0.63920208,	0.63660017,	0.63920208,	0.63660017)
gb_ga_pl <- c(0.666667,	0.643229,	0.622396,	0.635417,	0.638021,	0.641146)

gb_ga_income <- c(0.872821,	0.868402,	0.872575,	0.870366,	0.867420)
bg_rs_income <- c(0.87306654,	0.87429413,	0.87429413,	0.87429413,	0.87306654)

t.test(gb_rs_pl, gb_ga_pl, alternative = "two.sided", var.equal = FALSE)
